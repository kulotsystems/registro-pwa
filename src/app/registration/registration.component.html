<!-- UPGRADE : switch to reactive form approach for easier scaling -->

<form (ngSubmit)="onSubmit(registrationForm.value)" #registrationForm="ngForm">
    <div class="container-fluid shadow-sm header mb-5 text-center">
        <div class="row m-2">
            <div class="col-sm-12">
                <strong>Register New User</strong>
                <button type="button" class="close" aria-label="Close" routerLink="/users">
                    <span aria-hidden="true">&times;</span>
                  </button>
            </div>
        </div>
    </div>
    <div class="container"><div class="row"><div class="col-sm-12 mt-5"><br /></div></div></div>
    <fieldset ngModelGroup="personal" #personal="ngModelGroup">
        <div class="container">
            <div class="form-group row">
                <label for="firstName" class="col-sm-3 col-form-label">First Name
                    <span class="text-danger" *ngIf="firstName.invalid && ( firstName.touched || firstName.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-9">
                    <input type="text"  
                        required
                        class="form-control"
                        name="firstName"
                        id="firstName"
                        placeholder="First Name"
                        #firstName="ngModel"
                        ngModel>
                </div>
            </div>
            <div class="form-group row">
                <label for="lastName" class="col-sm-3 col-form-label">Last Name
                    <span class="text-danger" *ngIf="lastName.invalid && ( lastName.touched || lastName.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-9">
                    <input type="text"  
                        required
                        class="form-control"
                        name="lastName"
                        id="lastName"
                        placeholder="Last Name"
                        #lastName="ngModel"
                        ngModel>
                </div>
            </div>
            <div class="form-group row">
                <label for="middleInitial" class="col-sm-3 col-form-label">Middle Initial
                    <span class="text-danger" *ngIf="middleInitial.invalid && ( middleInitial.touched || middleInitial.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-3">
                    <input type="text"  
                        required
                        class="form-control"
                        name="middleInitial"
                        id="middleInitial"
                        placeholder="M.I."
                        maxlength="1"
                        #middleInitial="ngModel"
                        ngModel>
                </div>
            </div>
            <div class="form-group row">
                <label for="sex" class="col-sm-3 col-form-label">Sex
                    <span class="text-danger" *ngIf="sex.invalid && ( sex.touched || sex.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-3">
                    <select required
                            class="form-control"
                            id="sex"
                            name="sex" 
                            #sex="ngModel"
                            ngModel>
                        <option>Male</option>
                        <option>Female</option>
                        </select>
                </div>
            </div>
            <br />  
            <div class="form-group row">
                <label for="birthdate" class="col-sm-3 col-form-label">Date of Birth
                    <span class="text-danger" *ngIf="birthdate.invalid && ( birthdate.touched || birthdate.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-9">
                    <input type="date"
                        required
                        class="form-control col-sm-5"
                        name="birthdate"
                        id="birthdate"
                        #birthdate="ngModel"
                        ngModel>
                </div>
            </div>
            <div class="form-group row">
                <label for="age" class="col-sm-3 col-form-label">Age
                    <span class="text-danger" *ngIf="age.invalid && ( age.touched || age.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                    <span class="text-danger" *ngIf="age.value < 0 && ( age.touched || age.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        invalid age
                    </span>
                </label>
                <div class="col-sm-4">
                    <input type="number"  
                        required
                        class="form-control"
                        name="age"
                        id="age"
                        placeholder="ex. 21"
                        min="0"
                        #age="ngModel"
                        ngModel>
                </div>
            </div>
        </div>
    </fieldset>
    <fieldset ngModelGroup="address" #address="ngModelGroup">
        <div class="container">
            <div class="row">
                <div class="col-sm-12"><hr></div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <h5>Address</h5>
                </div>
            </div>
            <div class="form-group row">
                <label for="houseNumber" class="col-sm-3 col-form-label">House/Lot/Bldg No.</label>
                <div class="col-sm-9">
                    <input type="text"
                           class="form-control"
                           id="houseNumber"
                           name="houseNumber"
                           placeholder="ex. #58, 1425"
                           ngModel>
                </div>
            </div>
            <div class="p-2 border-danger" [ngClass]="{'border' : ( zone.invalid && street.invalid ) && ( zone.touched || zone.dirty || street.touched || street.dirty ) }">
                <span class="text-danger" *ngIf="( zone.invalid && street.invalid ) && ( zone.touched || zone.dirty || street.touched || street.dirty )">
                    <span class="badge badge-danger">ðŸ›ˆ</span>
                    fill up one of these two
                </span>
                <div class="form-group row">
                    <label for="zone" class="col-sm-3 col-form-label">Zone</label>
                    <div class="col-sm-9">
                        <input type="text"
                               required
                               class="form-control"
                               id="zone"
                               name="zone"
                               placeholder="ex. Zone 1, Sona 2, Purok 3"
                               #zone="ngModel"
                               ngModel>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="street" class="col-sm-3 col-form-label">Street</label>
                    <div class="col-sm-9">
                        <input type="text"
                               required
                               class="form-control"
                               id="street"
                               name="street"
                               placeholder="Luna Street, Malate Drive"
                               #street="ngModel"
                               ngModel>
                    </div>
                </div>
            </div>

            <div class="p-2 border-danger" [ngClass]="{'border' : ( subdivision.invalid && barangay.invalid ) && ( subdivision.touched || subdivision.dirty || barangay.touched || barangay.dirty ) }">
                <span class="text-danger" *ngIf="( subdivision.invalid && barangay.invalid ) && ( subdivision.touched || subdivision.dirty || barangay.touched || barangay.dirty )">
                    <span class="badge badge-danger">ðŸ›ˆ</span>
                    fill up one of these two
                </span>
                <div class="form-group row">
                    <label for="subdivision" class="col-sm-3 col-form-label">Subdivision</label>
                    <div class="col-sm-9">
                        <input type="text"
                               required
                               class="form-control"
                               id="subdivision"
                               name="subdivision"
                               placeholder="ex. Ramada Village, Victoria Subdivision"
                               #subdivision="ngModel"
                               ngModel>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="barangay" class="col-sm-3 col-form-label">Barangay</label>
                    <div class="col-sm-9">
                        <input type="text"
                               required
                               class="form-control"
                               id="barangay"
                               name="barangay"
                               placeholder="ex. San Nicolas, Bgy 145, Santiago Young"
                               #barangay="ngModel"
                               ngModel>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <label for="city" class="col-sm-3 col-form-label">City / Municipality
                    <span class="text-danger" *ngIf="city.invalid && ( city.touched || city.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-9">
                    <input type="text"
                           required
                           class="form-control"
                           id="city"
                           name="city"
                           placeholder="ex. Nabua, Manila, Olongapo"
                           #city="ngModel"
                           ngModel>
                </div>
            </div>
            <div class="form-group row">
                <label for="province" class="col-sm-3 col-form-label">Province
                    <span class="text-danger" *ngIf="province.invalid && ( province.touched || province.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-9">
                    <input type="text"
                           required
                           class="form-control"
                           id="province"
                           name="province"
                           placeholder="ex. Camarines Sur, Quezon"
                           #province="ngModel"
                           ngModel>
                </div>
            </div>
            <div class="form-group row">
                <label for="region" class="col-sm-3 col-form-label">Region
                    <span class="text-danger" *ngIf="region.invalid && ( region.touched || region.dirty )"> 
                        <span class="badge badge-danger">ðŸ›ˆ</span>
                        required
                    </span>
                </label>
                <div class="col-sm-9">
                    <input type="text"
                           required
                           class="form-control"
                           id="region"
                           name="region"
                           placeholder="ex. MIMAROPA, Bicol"
                           #region="ngModel"
                           ngModel>
                </div>
            </div>
        </div>
    </fieldset>
    <div class="container"><div class="row"><div class="col-sm-12"><hr></div></div></div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h5>Review Data Privacy Act</h5>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <div class="form-check">
                    <input class="form-check-input"
                            required
                            type="checkbox"
                            value=""
                            id="certify" 
                            name="certify"
                            #certify="ngModel"
                            ngModel>
                    <label class="form-check-label" for="defaultCheck1">
                      I hereby certify that the data I provided is accurate at the time of registration. I understand my data will only be used exclusively for COVID-19 contact tracing efforts by a certified government agency.
                    </label>
                  </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="col-sm-12 text-center">
            <button type="submit"
                    class="btn btn-lg btn-success m-5"
                    [disabled]="!( certify.valid && personal.valid && ( ( zone.valid || street.valid ) && (subdivision.valid || barangay.valid) && city.valid && province.valid && region.valid ))">Submit
            </button>
        </div>
    </div>
</form>